# --- CELL 1: FULL ENVIRONMENT RESET AND SETUP ---
import os
import sys

# 1. Force the system to use the installed environment path
# This prevents the ModuleNotFoundError in the next cell
sys.path.append('/usr/local/envs/quantum_env/lib/python3.9/site-packages')

# 2. Check and Install Environment (if necessary)
# This removes old versions and ensures we start clean.
if os.path.exists('/usr/local/envs/quantum_env'):
    print("✅ ENVIRONMENT ALREADY INSTALLED. Proceed to Cell 2.")
else:
    print("⏳ Setting up Python 3.9 Environment... (This takes ~90 seconds)")
    
    # 2a. Install Miniconda (Python 3.9)
    os.system('wget -qO mini.sh https://repo.anaconda.com/miniconda/Miniconda3-py39_23.3.1-0-Linux-x86_64.sh')
    os.system('chmod +x mini.sh')
    os.system('bash ./mini.sh -b -f -p /usr/local > /dev/null')
    os.system('/usr/local/bin/conda create -y -n quantum_env python=3.9 > /dev/null')
    
    # 2b. Install Quantum and Data Libraries
    PYTHON_EXEC = '/usr/local/envs/quantum_env/bin/python'
    os.system(f'{PYTHON_EXEC} -m pip install -q tensorflow==2.15.0 tensorflow-quantum==0.7.3 cirq==1.3.0 sympy==1.12 nba_api pandas requests tqdm')

    print("✅ ENVIRONMENT SETUP COMPLETE.")

# 3. Final verification printout
print("Proceed to Cell 2 to run the prediction script.")
